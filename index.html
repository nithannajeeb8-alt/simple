<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Nithan (Portfolio) </title>
  <meta name="description" content="Portfolio of Nithan: web experiments, Mind Atlas, and creative projects." />

  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">

  <style>
    :root {
      --bg-1: #040103;
      --bg-2: #130004;
      --accent: #ff004c;
      --accent-2: #ff2d6f;
      --muted: rgba(255, 255, 255, 0.78);
      --mono: 'Orbitron', system-ui, sans-serif;
      --ui: 'Inter', system-ui, sans-serif;
    }

    * { box-sizing: border-box; }
    html { scroll-behavior: smooth; }
    
    /* SCROLL LOCKED INITIALLY FOR BOOT SCREEN */
    html, body { height: 100%; margin: 0; }
    body {
      font-family: var(--ui); color: #fff; background: var(--bg-1);
      -webkit-font-smoothing: antialiased;
      overflow: hidden; /* Prevents scrolling during boot */
    }
    
    /* Hide default cursor on desktop, handled by JS later */
    @media (hover: hover) and (pointer: fine) { body { cursor: none; } }

    /* --- CUSTOM CURSOR --- */
    #cursor, #cursor-trail {
      position: fixed; left: 0; top: 0; pointer-events: none; 
      z-index: 999999; /* Absolute highest layer */
      transform: translate(-50%, -50%); border-radius: 50%;
      opacity: 0; /* Hidden until mouse moves */
      transition: opacity 0.3s ease;
    }
    #cursor { width: 10px; height: 10px; background: var(--accent); box-shadow: 0 0 20px var(--accent); }
    #cursor-trail {
      width: 40px; height: 40px; border: 1px solid rgba(255, 0, 76, 0.5);
      transition: width 0.2s, height 0.2s, background 0.2s, opacity 0.3s ease;
    }
    #cursor-trail.hover { width: 70px; height: 70px; background: rgba(255, 0, 76, 0.1); border-color: transparent; }

    /* --- BOOT SCREEN --- */
    #boot-screen {
      position: fixed; inset: 0; z-index: 100000;
      background: var(--bg-1); /* Solid background to hide main content */
      display: flex; align-items: center; justify-content: center; flex-direction: column;
      background-image: repeating-linear-gradient(to bottom, transparent, transparent 2px, rgba(255, 0, 76, 0.05) 3px);
      padding: 20px;
    }
    .boot-content { width: 100%; max-width: 500px; display: flex; flex-direction: column; align-items: center; text-align: center; }
    #terminal-output {
      width: 100%; text-align: left; color: var(--accent); font-family: var(--mono);
      font-size: 0.9rem; line-height: 1.8; margin-top: 30px; min-height: 140px;
    }
    #progress-container { width: 100%; height: 4px; background: rgba(255,255,255,0.1); margin-top: 24px; border-radius: 4px; overflow: hidden; }
    #progress-bar { width: 0%; height: 100%; background: var(--accent); box-shadow: 0 0 15px var(--accent); }

    /* --- AMBIENT BACKGROUNDS --- */
    .bg { position: fixed; inset: 0; z-index: 0; pointer-events: none; background: radial-gradient(circle at 14% 18%, rgba(255, 0, 76, 0.15), transparent 40%), radial-gradient(circle at 86% 82%, rgba(255, 30, 90, 0.08), transparent 40%), linear-gradient(180deg, var(--bg-1), var(--bg-2)); }
    .grid { position: fixed; inset: 0; z-index: 1; pointer-events: none; mix-blend-mode: screen; opacity: 0.12; background-image: linear-gradient(rgba(255, 0, 76, 0.1) 1px, transparent 1px), linear-gradient(90deg, rgba(255, 0, 76, 0.1) 1px, transparent 1px); background-size: 40px 40px; transform: perspective(500px) rotateX(20deg) scale(1.5) translateY(-5%); animation: gridMove 20s linear infinite; }
    @keyframes gridMove { 0% { transform: perspective(500px) rotateX(20deg) scale(1.5) translateY(0); } 100% { transform: perspective(500px) rotateX(20deg) scale(1.5) translateY(40px); } }
    .scanlines { position: fixed; inset: 0; z-index: 2; pointer-events: none; background: repeating-linear-gradient(to bottom, transparent, transparent 2px, rgba(0, 0, 0, 0.3) 3px); opacity: 0.3; }
    .particles { position: fixed; inset: 0; pointer-events: none; z-index: 3;}

    /* --- HEADER & NAV --- */
    header {
      position: fixed; top: 0; width: 100%; z-index: 50; padding: 16px 6vw;
      display: flex; align-items: center; justify-content: space-between;
      backdrop-filter: blur(12px); background: linear-gradient(180deg, rgba(4,1,3,0.8), transparent);
      border-bottom: 1px solid rgba(255, 0, 76, 0.1); transition: transform 0.4s ease;
    }
    .brand { display: flex; gap: 16px; align-items: center; }
    .logo { width: 50px; height: 50px; border-radius: 12px; background: linear-gradient(135deg, var(--accent), var(--accent-2)); display: grid; place-items: center; box-shadow: 0 0 20px rgba(255, 0, 76, 0.4); }
    nav { display: flex; gap: 24px; align-items: center; }
    nav a { color: var(--muted); text-decoration: none; padding: 8px 4px; font-weight: 600; letter-spacing: 1px; font-family: var(--mono); font-size: 0.85rem; text-transform: uppercase; position: relative; display: inline-block; cursor: none; }
    nav a::after { content: ''; position: absolute; width: 0; height: 2px; bottom: 0; left: 0; background: var(--accent); transition: width 0.3s ease; }
    
    @media (hover: hover) {
      nav a:hover { color: #fff; }
      nav a:hover::after { width: 100%; }
      .card:hover::before { left: 150%; }
      .card:hover { border-color: rgba(255, 0, 76, 0.4); box-shadow: 0 20px 50px rgba(255,0,76,0.15); transform: translateY(-5px); }
      .btn:hover { box-shadow: 0 0 25px rgba(255, 0, 76, 0.5); background: rgba(255, 0, 76, 0.1); }
      .btn:hover::before { transform: scaleX(1); transform-origin: left; }
    }

    /* --- MAIN LAYOUT & GSAP START STATES --- */
    main { position: relative; z-index: 20; padding: 140px 6vw 120px; }
    
    /* These classes hide elements initially so GSAP can animate them cleanly */
    .gs-reveal { opacity: 0; transform: translateY(40px); }
    .p-card { opacity: 0; transform: scale(0.8); }
    .scroll-card { opacity: 0; transform: translateY(50px); }

    .hero { display: grid; grid-template-columns: 1fr 400px; gap: 80px; align-items: center; min-height: 75vh; }
    .hero-content { display: flex; flex-direction: column; align-items: flex-start; }
    h1 { font-family: var(--mono); font-size: clamp(36px, 6.5vw, 84px); line-height: 0.95; color: #fff; text-shadow: 0 0 20px rgba(255, 0, 76, 0.6), 2px 2px 0px var(--accent); margin-bottom: 24px; text-wrap: balance; }
    p.lead { color: var(--muted); max-width: 600px; font-size: 1.1rem; line-height: 1.7; margin-bottom: 16px; text-wrap: balance; }

    /* --- INTERACTIVE CARDS --- */
    .panel, .card {
      background: rgba(15, 2, 7, 0.6); backdrop-filter: blur(10px); border-radius: 16px; padding: 28px;
      border: 1px solid rgba(255, 0, 76, 0.15); box-shadow: inset 0 0 20px rgba(255,0,76,0.02), 0 10px 40px rgba(0,0,0,0.8);
      transform-style: preserve-3d; will-change: transform; position: relative; overflow: hidden;
      transition: transform 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
    }
    .card::before { content: ''; position: absolute; top: 0; left: -100%; width: 50%; height: 100%; background: linear-gradient(90deg, transparent, rgba(255,0,76,0.1), transparent); transform: skewX(-20deg); transition: 0.6s ease; }

    section { margin-top: 140px; }
    .two-col { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 32px; }
    .about-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }

    /* --- BUTTONS --- */
    .btn {
      background: transparent; color: #fff; border: 1px solid var(--accent); padding: 16px 36px;
      border-radius: 8px; font-weight: 700; font-family: var(--mono); text-transform: uppercase; letter-spacing: 2px;
      cursor: none; position: relative; overflow: hidden; display: inline-block; transition: all 0.3s ease;
    }
    .btn::before { content: ''; position: absolute; inset: 0; background: var(--accent); transform: scaleX(0); transform-origin: right; transition: transform 0.4s cubic-bezier(0.86, 0, 0.07, 1); z-index: -1; }

    footer { padding: 40px 6vw; text-align: center; border-top: 1px solid rgba(255, 0, 76, 0.2); color: var(--muted); font-family: var(--mono); font-size: 0.9rem; margin-top: 80px; }

    /* --- MOBILE RESPONSIVE TWEAKS --- */
        @media(max-width: 600px) {
      header { flex-direction: column; padding: 16px 4vw; gap: 16px; }
      .brand { justify-content: center; width: 100%; }
      nav { gap: 12px; flex-wrap: wrap; justify-content: center; width: 100%; }
      nav a { padding: 6px 8px; font-size: 0.75rem; }
      
      main { padding-top: 150px; } 
      
      /* --- THE NEW TACTICAL HUD AESTHETIC --- */
      .hero { 
        display: flex; 
        flex-direction: column; 
        align-items: stretch; /* Stretches children to full width */
        gap: 32px; 
      }
      
      .hero-content { 
        align-items: flex-start; 
        text-align: left; 
        width: 100%; 
        /* HUD Framing */
        border-left: 3px solid var(--accent);
        padding: 16px 0 16px 20px;
        background: linear-gradient(90deg, rgba(255,0,76,0.08) 0%, transparent 100%);
        border-radius: 0 16px 16px 0;
      }
      
      h1 { font-size: 2.5rem; margin-bottom: 16px; text-align: left; }
      p.lead { text-align: left; font-size: 1rem; line-height: 1.6; margin-bottom: 12px; }
      
      /* Full-width mobile app-style button */
      .hero-content > div { width: 100%; margin-top: 16px; padding-right: 20px; }
      .hero-content .btn { 
        width: 100%; 
        display: flex; 
        justify-content: space-between; 
        align-items: center; 
        padding: 16px 24px;
      }
      .hero-content .btn::after {
        content: '>>';
        font-family: var(--mono);
        color: var(--muted);
        transition: color 0.3s ease;
      }
      .hero-content .btn:active::after { color: #fff; }
      
      .two-col { grid-template-columns: 1fr; gap: 24px; }
    }


    /* Strict Mobile Touch Overrides */
    @media (pointer: coarse) {
      #cursor, #cursor-trail { display: none !important; }
      body, a, button, .btn { cursor: auto !important; }
      nav a, .btn, a, .card { cursor: pointer !important; }
      .card:active { transform: scale(0.97); border-color: var(--accent); }
      .btn:active { transform: scale(0.95); background: rgba(255,0,76,0.3); }
      nav a:active { color: var(--accent); }
    }

    /* Touch Ripple Effect Class */
    .touch-ripple { position: absolute; border-radius: 50%; transform: scale(0); animation: ripple 0.6s linear; background: rgba(255, 255, 255, 0.3); pointer-events: none; }
    @keyframes ripple { to { transform: scale(4); opacity: 0; } }
  </style>
</head>
<body>

  <div id="cursor"></div>
  <div id="cursor-trail"></div>

  <div id="boot-screen">
    <div class="boot-content">
      <div class="logo" style="margin-bottom:24px; width:72px; height:72px;">
        <div id="logo-lottie-boot" style="width:100px; height:100px;"></div>
      </div>
      <h1 class="glitch-text" data-value="SYSTEM STANDBY" style="font-size: clamp(24px, 5vw, 36px); margin-bottom: 40px;">SYSTEM STANDBY</h1>
      <button id="init-btn" class="btn interactive-el magnetic">INITIALIZE</button>
      
      <div id="terminal-output" style="display:none;"></div>
      <div id="progress-container" style="display:none;">
        <div id="progress-bar"></div>
      </div>
    </div>
  </div>

  <div class="bg"></div>
  <div class="grid"></div>
  <div class="scanlines"></div>

  <canvas id="p-back" class="particles" style="z-index:3; opacity:0.4"></canvas>
  <canvas id="p-mid" class="particles" style="z-index:4; opacity:0.7"></canvas>
  <canvas id="p-front" class="particles" style="z-index:5; opacity:1"></canvas>

  <header id="navbar">
    <div class="brand">
      <div class="logo"><div id="logo-lottie" style="width:68px; height:68px"></div></div>
      <div>
        <div style="font-weight:900; font-family:var(--mono); letter-spacing:1px">NITHAN</div>
        <div style="font-size:11px; color:var(--accent)">SYS_ONLINE // V_5.2</div>
      </div>
    </div>
    <nav>
      <a href="#about" class="magnetic interactive-el">Data</a>
      <a href="#projects" class="magnetic interactive-el">Modules</a>
      <a href="#contact" class="magnetic interactive-el">Comm</a>
    </nav>
  </header>

  <main id="main-content">
    <section class="hero">
      <div class="hero-content">
        <h1 id="hero-title" class="glitch-text" data-value="WELCOME">WELCOME</h1>
        <p class="lead gs-reveal">Hi. Iâ€™m <strong style="color:#fff;">NITHAN</strong>. B.Com student by day, digital architect by night. I build web UI, write stories, and engineer interactive tools.</p>
        <p class="lead gs-reveal">Current objectives: UI experimentation, <strong style="color:#fff;">Mind Atlas</strong> knowledge systems, <strong style="color:#fff;">Forenexa</strong> storefronts, and local AI integration.</p>
        <div style="margin-top:40px" class="gs-reveal">
          <a href="#projects" style="text-decoration:none;"><button class="btn magnetic interactive-el">Access Modules</button></a>
        </div>
      </div>

      <aside class="panel floaty gs-reveal" aria-hidden="true" style="width: 100%; max-width: 420px;">
        <div style="display:flex; justify-content:space-between; align-items:center; border-bottom:1px solid rgba(255,0,76,0.2); padding-bottom:12px; margin-bottom:20px;">
            <div style="font-family:var(--mono); color:var(--accent); font-size:0.9rem;">USER_PROFILE</div>
            <div style="width:10px; height:10px; border-radius:50%; background:#0f0; box-shadow:0 0 10px #0f0; animation: pulse 1.5s infinite;"></div>
        </div>
        <div class="about-grid">
          <div class="card p-card interactive-el">ID:<br><strong style="color:var(--accent)">RUBIN STELLAR</strong></div>
          <div class="card p-card interactive-el">CLS:<br><strong>Student (B.Com)</strong></div>
          <div class="card p-card interactive-el">CLG:<br><strong>MES College</strong></div>
          <div class="card p-card interactive-el">LOC:<br><strong>India</strong></div>
          <div class="card p-card interactive-el">DOB:<br><strong>2004</strong></div>
          <div class="card p-card interactive-el">PROJ:<br><strong>MIND ATLAS</strong></div>
        </div>
      </aside>
    </section>

    <section id="about">
      <h2 class="glitch-text" data-value="01 // ARCHIVE_DATA" style="font-family:var(--mono); color:var(--accent); margin-bottom:40px">01 // ARCHIVE_DATA</h2>
      <div class="two-col">
        <div class="card scroll-card interactive-el">
          <h3 style="font-family:var(--mono); border-bottom:1px solid rgba(255,255,255,0.1); padding-bottom:14px;">Biography</h3>
          <p style="color:var(--muted); margin-top:20px; line-height: 1.8;">I blend code, content, and craft. Beyond the business degree, my real playground is the web. I build tools to remember, reflect, and create.</p>
        </div>
        <div class="card scroll-card interactive-el">
          <h3 style="font-family:var(--mono); border-bottom:1px solid rgba(255,255,255,0.1); padding-bottom:14px;">Tech Specs</h3>
          <ul style="color:var(--muted); line-height:1.8; margin-top:20px; padding-left:20px;">
            <li><strong style="color:var(--accent)">Core:</strong> HTML5, CSS3, Vanilla JS</li>
            <li><strong style="color:var(--accent)">Motion:</strong> GSAP, Lottie, Canvas API</li>
            <li><strong style="color:var(--accent)">R&D:</strong> Ollama (Local LLMs)</li>
          </ul>
        </div>
      </div>
    </section>

    <section id="projects">
      <h2 class="glitch-text" data-value="02 // ACTIVE_MODULES" style="font-family:var(--mono); color:var(--accent); margin-bottom:40px">02 // ACTIVE_MODULES</h2>
      <div class="two-col">
        <div class="card scroll-card interactive-el">
          <h3 style="font-family:var(--mono);">Mind Atlas</h3>
          <p style="color:var(--muted); font-size:0.95rem; margin-top:12px; line-height: 1.6;">Personalized knowledge node. Tracking science, philosophy, and code logic to forge a permanent secondary brain.</p>
        </div>
        <div class="card scroll-card interactive-el">
          <h3 style="font-family:var(--mono);">Forenexa</h3>
          <p style="color:var(--muted); font-size:0.95rem; margin-top:12px; line-height: 1.6;">Digital storefront architecture optimized for physical, small-batch handcrafted hardware (goods).</p>
        </div>
        <div class="card scroll-card interactive-el">
          <h3 style="font-family:var(--mono);">Born Legend</h3>
          <p style="color:var(--muted); font-size:0.95rem; margin-top:12px; line-height: 1.6;">Creative text databanks. A fantasy narrative protocol exploring unity, sacrifice, and redemption arcs.</p>
        </div>
        <div class="card scroll-card interactive-el">
          <h3 style="font-family:var(--mono);">Ollama Uplink</h3>
          <p style="color:var(--muted); font-size:0.95rem; margin-top:12px; line-height: 1.6;">WIP protocol to tether a localized, private AI instance to this exact frontend for seamless cross-device querying.</p>
        </div>
      </div>
    </section>

    <section id="contact">
      <h2 class="glitch-text" data-value="03 // COMMS_LINK" style="font-family:var(--mono); color:var(--accent); margin-bottom:40px">03 // COMMS_LINK</h2>
      <div class="two-col">
        <div class="card scroll-card interactive-el" style="display:flex; flex-direction:column; justify-content:center; align-items:center; text-align:center; padding: 40px;">
          <h3 style="font-family:var(--mono);">Transmit Signal</h3>
          <p style="margin:24px 0;"><a href="mailto:mail@nithan.in" style="color:var(--accent); text-decoration:none; font-size:1.4rem; font-weight:bold; font-family:var(--mono); letter-spacing: 1px;">contact</a></p>
        </div>
      </div>
    </section>
  </main>

  <footer>
    <p>NODE HOSTED AT <span style="color:var(--accent)">NITHAN.IN</span> // SYSTEM YEAR <span id="year"></span></p>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.2/dist/gsap.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.2/dist/ScrollTrigger.min.js"></script>

  <script>
    gsap.registerPlugin(ScrollTrigger);
    document.getElementById('year').textContent = new Date().getFullYear();

    // --- BULLETPROOF CURSOR LOGIC ---
    // Instead of relying on buggy media queries for hybrid laptops, we detect physical mouse movement.
    let hasTouch = false;
    let cursorVisible = false;
    const cursor = document.getElementById('cursor');
    const cursorTrail = document.getElementById('cursor-trail');
    let mouse = { x: window.innerWidth / 2, y: window.innerHeight / 2 };
    let trail = { x: window.innerWidth / 2, y: window.innerHeight / 2 };

    window.addEventListener('touchstart', () => { hasTouch = true; }, { once: true, passive: true });

    window.addEventListener('mousemove', e => {
      if (hasTouch) return; // Ignore if user has touched the screen
      
      // Show cursor only on the very first mouse movement
      if (!cursorVisible) {
        cursor.style.opacity = '1';
        cursorTrail.style.opacity = '1';
        cursorVisible = true;
      }
      
      mouse.x = e.clientX; 
      mouse.y = e.clientY;
      cursor.style.transform = `translate3d(${mouse.x}px, ${mouse.y}px, 0) translate(-50%, -50%)`;
    });

    function animateTrail() {
      if(cursorVisible) {
        trail.x += (mouse.x - trail.x) * 0.15; 
        trail.y += (mouse.y - trail.y) * 0.15;
        cursorTrail.style.transform = `translate3d(${trail.x}px, ${trail.y}px, 0) translate(-50%, -50%)`;
      }
      requestAnimationFrame(animateTrail);
    }
    animateTrail();

    // Hover states for cursor
    document.querySelectorAll('a, button, .card').forEach(el => {
      el.addEventListener('mouseenter', () => cursorTrail.classList.add('hover'));
      el.addEventListener('mouseleave', () => cursorTrail.classList.remove('hover'));
    });

    // Magnetic buttons (Desktop only)
    document.querySelectorAll('.magnetic').forEach(el => {
      el.addEventListener('mousemove', (e) => {
        if(hasTouch) return;
        const rect = el.getBoundingClientRect();
        gsap.to(el, { x: (e.clientX - rect.left - rect.width/2) * 0.4, y: (e.clientY - rect.top - rect.height/2) * 0.4, duration: 0.3 });
      });
      el.addEventListener('mouseleave', () => {
        if(hasTouch) return;
        gsap.to(el, { x: 0, y: 0, duration: 0.7, ease: 'elastic.out(1, 0.3)' });
      });
    });

    // 3D Tilt for cards (Desktop only)
    document.querySelectorAll('.card').forEach(card => {
      card.addEventListener('mousemove', e => {
        if(hasTouch) return;
        const rect = card.getBoundingClientRect();
        const rotateX = ((e.clientY - rect.top - rect.height / 2) / rect.height) * -12; 
        const rotateY = ((e.clientX - rect.left - rect.width / 2) / rect.width) * 12;
        card.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg) scale3d(1.02, 1.02, 1.02)`;
      });
      card.addEventListener('mouseleave', () => {
        if(hasTouch) return;
        card.style.transform = 'perspective(1000px) rotateX(0deg) rotateY(0deg) scale3d(1, 1, 1)';
      });
    });

    // --- GLITCH TEXT UTILITY ---
    const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789@#$%&*+<>_";
    function createGlitchEffect(el) {
      if (el.dataset.isGlitching === "true") return;
      el.dataset.isGlitching = "true";
      const originalText = el.dataset.value;
      let iterations = 0;
      
      const interval = setInterval(() => {
        el.innerText = originalText.split("").map((letter, index) => {
          if(index < iterations) return originalText[index];
          return chars[Math.floor(Math.random() * chars.length)];
        }).join("");
        
        if(iterations >= originalText.length) {
          clearInterval(interval);
          el.dataset.isGlitching = "false";
        }
        iterations += 1 / 2;
      }, 30);
    }

    // Initialize Glitch on Boot Title immediately
    createGlitchEffect(document.querySelector('#boot-screen .glitch-text'));

    document.querySelectorAll('main .glitch-text').forEach(el => {
      el.addEventListener('mouseenter', () => { if(!hasTouch) createGlitchEffect(el); });
      ScrollTrigger.create({ trigger: el, start: "top 85%", onEnter: () => createGlitchEffect(el) });
    });

    // --- BOOT SEQUENCE LOGIC ---
    const bootScreen = document.getElementById('boot-screen');
    const initBtn = document.getElementById('init-btn');
    const termOut = document.getElementById('terminal-output');
    const progCont = document.getElementById('progress-container');
    const progBar = document.getElementById('progress-bar');

    initBtn.addEventListener('click', () => {
      initBtn.style.display = 'none';
      termOut.style.display = 'block';
      progCont.style.display = 'block';

      const sequence = [
        "CONNECTING TO SECURE NODE [NITHAN.IN]...",
        "BYPASSING FIREWALL... SUCCESS",
        "DECRYPTING USER_PROFILE [RUBIN_STELLAR]...",
        "MOUNTING UI MODULES & PARTICLE ENGINE...",
        "ESTABLISHING COMMS LINK...",
        "ACCESS GRANTED."
      ];

      let delay = 0;
      sequence.forEach((text, i) => {
        let typingSpeed = delay + (Math.random() * 400 + 300); 
        setTimeout(() => {
          const line = document.createElement('div');
          line.innerText = `> ${text}`;
          termOut.appendChild(line);
          gsap.to(progBar, {width: `${(i+1)*(100/sequence.length)}%`, duration: 0.5, ease: "power2.out"});
        }, typingSpeed);
        delay = typingSpeed;
      });

      setTimeout(() => {
        gsap.to(bootScreen, {
          yPercent: -100, opacity: 0, duration: 1.2, ease: "power4.inOut",
          onComplete: () => {
            bootScreen.remove();
            startPortfolioAnimations();
          }
        });
      }, delay + 800);
    });

    // --- MAIN PORTFOLIO ANIMATIONS (FLAWLESS REVEAL) ---
    function startPortfolioAnimations() {
      // 1. Unlock scrolling so user can move down
      document.body.style.overflow = 'auto';
      document.body.style.overflowX = 'hidden';

      // 2. Animate Hero Section (From initial hidden CSS state to visible)
      gsap.to('.gs-reveal', { y: 0, opacity: 1, duration: 1.2, stagger: 0.2, ease: 'power3.out' });
      gsap.to('.p-card', { scale: 1, opacity: 1, duration: 0.8, stagger: 0.1, ease: 'back.out(1.5)', delay: 0.6 });

      // 3. Setup ScrollTriggers for lower cards
      gsap.utils.toArray('.scroll-card').forEach(card => {
        gsap.to(card, {
          scrollTrigger: { 
            trigger: card, 
            start: "top 90%", // Animates when top of card hits bottom 10% of screen
            toggleActions: "play none none reverse" 
          },
          y: 0, opacity: 1, duration: 0.8, ease: "power3.out"
        });
      });

      // 4. Crucial: Refresh GSAP math now that scrollbar exists
      setTimeout(() => ScrollTrigger.refresh(), 100);
    }

    // --- MOBILE TACTILE RIPPLE EFFECT ---
    document.querySelectorAll('.interactive-el').forEach(btn => {
      btn.addEventListener('click', function(e) {
        if(!hasTouch) return; 
        let x = e.clientX - e.target.getBoundingClientRect().left;
        let y = e.clientY - e.target.getBoundingClientRect().top;
        
        let ripples = document.createElement('span');
        ripples.style.left = x + 'px'; ripples.style.top = y + 'px';
        ripples.classList.add('touch-ripple');
        this.appendChild(ripples);
        
        setTimeout(() => ripples.remove(), 600);
      });
    });

    // --- NAVBAR HIDE ON SCROLL ---
    let lastScroll = 0;
    window.addEventListener('scroll', () => {
      const currentScroll = window.pageYOffset;
      if (currentScroll > 100 && currentScroll > lastScroll) document.getElementById('navbar').style.transform = 'translateY(-100%)';
      else document.getElementById('navbar').style.transform = 'translateY(0)';
      lastScroll = currentScroll;
    }, {passive: true});

    // --- PARALLAX PARTICLES ---
    const canvases = [document.getElementById('p-back'), document.getElementById('p-mid'), document.getElementById('p-front')];
    class ParticleLayer {
      constructor(canvas, count, speedRange, sizeRange, colorBase, parallaxSpeed) {
        this.canvas = canvas; this.ctx = canvas.getContext('2d');
        this.count = count; this.speedRange = speedRange; this.sizeRange = sizeRange; 
        this.colorBase = colorBase; this.parallaxSpeed = parallaxSpeed; this.particles = [];
        this.resize(); window.addEventListener('resize', () => this.resize());
        for(let i=0; i<this.count; i++) this.particles.push(this.create());
      }
      resize() { this.w = window.innerWidth; this.h = window.innerHeight; this.canvas.width = this.w; this.canvas.height = this.h; }
      create() { return { x: Math.random() * this.w, y: Math.random() * this.h, size: this.sizeRange[0] + Math.random() * (this.sizeRange[1] - this.sizeRange[0]), speed: this.speedRange[0] + Math.random() * (this.speedRange[1] - this.speedRange[0]), hue: this.colorBase + (Math.random() * 20 - 10), alpha: 0.2 + Math.random() * 0.8 }; }
      render(scrollY) {
        this.ctx.clearRect(0, 0, this.w, this.h);
        this.particles.forEach(p => {
          p.y -= p.speed;
          let renderY = p.y - (scrollY * this.parallaxSpeed);
          if (renderY < -50) p.y = this.h + 50 + (scrollY * this.parallaxSpeed);
          if (renderY > this.h + 50) p.y = -50 + (scrollY * this.parallaxSpeed);
          p.x += Math.sin(p.y * 0.01) * 0.5;
          if (p.x > this.w + 20) p.x = -20; if (p.x < -20) p.x = this.w + 20;
          this.ctx.beginPath(); this.ctx.fillStyle = `hsla(${p.hue}, 100%, 50%, ${p.alpha})`;
          this.ctx.arc(p.x, renderY, p.size, 0, Math.PI * 2); this.ctx.fill();
        });
      }
    }

    const mult = window.innerWidth > 600 ? 1 : 0.5; // Cut particles in half for mobile
    const layers = [
      new ParticleLayer(canvases[0], 40*mult, [0.1, 0.3], [1, 3], 340, 0.1),
      new ParticleLayer(canvases[1], 30*mult, [0.3, 0.7], [2, 5], 345, 0.3),
      new ParticleLayer(canvases[2], 20*mult, [0.8, 1.5], [3, 8], 350, 0.6)
    ];

    function renderParticles() {
      const scrollY = window.pageYOffset;
      layers.forEach(layer => layer.render(scrollY));
      requestAnimationFrame(renderParticles);
    }
    renderParticles();
  </script>
</body>
</html>
